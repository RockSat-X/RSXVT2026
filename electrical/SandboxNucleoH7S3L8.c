#include "defs.h"
#include "jig.c"



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



INTERRUPT_Default
{
    panic;
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



FREERTOS_TASK(task_a, 400, tskIDLE_PRIORITY)
{
    for (;;)
    {
        GPIO_TOGGLE(led_green);
        vTaskDelay(10);
    }
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



FREERTOS_TASK(task_b, 400, tskIDLE_PRIORITY)
{
    for (;;)
    {
        GPIO_TOGGLE(led_yellow);
        vTaskDelay(15);
    }
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



FREERTOS_TASK(task_c, 400, tskIDLE_PRIORITY)
{
    for (;;)
    {
        GPIO_TOGGLE(led_red);
        vTaskDelay(20);
    }
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



extern noret void
main(void)
{
    SYSTEM_init();
    JIG_init();

    #if TARGET_USES_FREERTOS

        FREERTOS_init();

    #else

        for (;;)
        {
            GPIO_TOGGLE(led_green);
            spinlock_nop(100'000'000);
        }

    #endif
}
